# Telegram Bot for System Monitoring and Log Management

The Telegram Bot is a versatile tool designed to monitor the status of various systems and manage logs. The bot can analyze logs, establish connections, check system health, and perform custom functions to assess system status. It reports this information to a designated Telegram channel and can also push logs to a remote server. The bot is designed to be flexible and easy to configure, making it a powerful tool for system monitoring and reporting.

## Installation

1. Clone the repository from GitHub:

```
pip install git+https://github.com/truflationdev/telegram_bot.git

```



## Configuration

1. Rename `.env_template` to `.env`:

```
mv src/telegram_bot/.env_template src/telegram_bot/.env
```

2. Open `.env` and set the environment variables according to your system and preferences. 


## Environment Variables

The bot uses environment variables for configuration. These are loaded from a `.env` file located in the `src/telegram_bot` directory. To set up your environment variables:

1. Rename `.env_template` to `.env`:

```
mv src/telegram_bot/.env_template src/telegram_bot/.env
```

2. Open `.env` and set the following variables:

### Logger Settings

- `SECURITY_LOGFILE`: Path to the file where security logs will be written.
- `GENERAL_LOGFILE`: Path to the file where general logs will be written.
- `LOG_LIFE`: Number of days to keep logs before deleting them.
- `RSA_ID_PATH`: Path to the RSA ID of the user for the `REMOTE_PATH` call.
- `REMOTE_PATH`: Remote path where logs are kept. Format: `username@host:path_to_directory`.

### Bot Server Settings

- `CHAT_ID`: Telegram chat ID for alert messages. You can get the chat ID by adding the bot to a group and using @RawDataBot.
- `HEARTBEAT_CHAT_ID`: Telegram chat ID for general monitoring messages.
- `LOG_BOT_KEY`: Key for the log bot on Telegram.
- `BOT_DIRECTORY`: Directory where the bot and aggregated log files will be kept.
- `LINKS_FILE_PATH`: Path to the JSON file containing links to check.
- `DAILY_FUNCTIONS_MODULE`: Path to the Python script with daily functions. The main function in this file will be called by the bot. Note the use of '.' to separate directories and file names.
- `HEARTBEAT_WAIT_PERIOD_FILE`: Path to the JSON file of heartbeat definitions. See example file for format.


## Examples

The `examples` directory contains sample scripts demonstrating how to use and configure the bot.

### Example Logging

This example demonstrates how to set up logging for the bot. It includes scripts to push logs to a remote server and to perform health checks on the systems being monitored. To run this example, set up your environment variables in the `.env` file (rename `.envTemplate` to `.env`), and execute the `push_logs.py` and `check_health.py` scripts.

[See the example in the repository.](https://github.com/truflationdev/telegram_bot/tree/main/examples/example_logging)

### Example Bot

This example demonstrates how to set up and run the Telegram bot. It includes a script for the main bot functionality, as well as configuration and requirements files. To run this example, install the required packages with `pip install -r requirements.txt`, set up your environment variables in the `.env` file (rename `.env_template` to `.env`), and execute the `example_bot.py` script.

[See the example in the repository.](https://github.com/truflationdev/telegram_bot/tree/main/examples/example_bot)


## Usage

1. Run the main bot script:

```
python3 src/telegram_bot/systems_monitor_bot.py
```

2. Run the shell script for getting system status and pushing it:

```
bash src/telegram_bot/get_and_push_system_status.sh
```

## Modules Overview

### [`systems_monitor_bot.py`](https://github.com/truflationdev/telegram_bot/blob/main/src/telegram_bot/systems_monitor_bot.py)

This is the main script for the Telegram bot. It monitors the status of various systems and reports the information to a designated Telegram channel.

### [`health_check.py`](https://github.com/truflationdev/telegram_bot/blob/main/src/telegram_bot/health_check.py)

This script performs health checks on the systems being monitored. It collects information about system status and reports any issues.

### [`general_logger.py`](https://github.com/truflationdev/telegram_bot/blob/main/src/telegram_bot/general_logger.py)

This script handles logging for the bot. It generates logs about the bot's activity and system status, and can push these logs to a remote server.

### [`push_logs_for_bot.py`](https://github.com/truflationdev/telegram_bot/blob/main/src/telegram_bot/push_logs_for_bot.py)

This script pushes logs generated by the bot to a remote server. It can be configured to push logs at regular intervals or in response to specific events.

### [`utilities.py`](https://github.com/truflationdev/telegram_bot/blob/main/src/telegram_bot/utilities.py)

This script contains utility functions that are used throughout the bot's code. These functions provide reusable functionality that helps keep the codebase clean and DRY.

## Contribution

Contributions to the Telegram Bot project are welcome! Please fork the repository, make your changes, and submit a pull request. We ask that you make sure your code follows the existing style and that all tests pass before you submit your pull request.
